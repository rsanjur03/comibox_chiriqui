---
import { db } from '../lib/firebase.js';
import { collection, getDocs, query, where, orderBy, limit } from 'firebase/firestore';

const hoy = new Date().toISOString().split('T')[0];
const q = query(
  collection(db, 'eventos'),
  where('fecha', '>=', hoy),
  orderBy('fecha', 'asc'),
  limit(1)
);
const snapshot = await getDocs(q);
const evento : any = snapshot.empty ? null : { id: snapshot.docs[0].id, ...snapshot.docs[0].data() };
---
<section class="mb-12">
  <h2 class="text-3xl font-bold text-white mb-6 text-center">Próximo Evento</h2>
  <div id="proximo-evento-container">
    {evento ? (
      <div class="bg-gray-800 rounded-lg shadow-xl overflow-hidden max-w-4xl mx-auto border-t-4 border-blue-600">
        <header class="p-6 md:p-8 text-center">
          <p class="text-2xl font-semibold text-blue-400">{evento.fecha}</p>
          <h3 class="text-4xl font-bold tracking-tight text-white mb-2">{evento.nombre}</h3>
          <p class="text-xl text-gray-300 font-medium">{evento.lugar}</p>
          <p class="text-lg text-gray-400 mt-2">Promotor: {evento.promotor}</p>
          <a href={`/eventos/${evento.id}`} class="mt-6 inline-block bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-6 rounded-lg text-lg transition-colors">
            Ver Cartelera
          </a>
        </header>
      </div>
    ) : (
      <p id="loading-evento" class="text-center text-gray-400 text-lg">No hay próximos eventos programados.</p>
    )}
  </div>
</section>
