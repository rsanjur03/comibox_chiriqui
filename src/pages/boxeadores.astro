---
// PARTE 1: CÓDIGO DEL SERVIDOR

// Importamos el menú que acabamos de crear
import Nav from '../components/Nav.astro';

// Importamos la base de datos y las funciones de Firestore
import { db } from '../lib/firebase.js';
import { collection, getDocs, query, orderBy } from 'firebase/firestore';

// Función para obtener los boxeadores, ordenados por nombre
async function getBoxeadores() {
  const boxeadoresRef = collection(db, "boxeadores");
  const q = query(boxeadoresRef, orderBy("nombre", "asc"));

  const querySnapshot = await getDocs(q);

  return querySnapshot.docs.map(doc => ({
    id: doc.id,
    ...doc.data()
  }));
}

// Ejecutamos la función
const boxeadores = await getBoxeadores();
---

<html lang="es">
<head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <title>Récord de Boxeadores - COMIBOX Chiriquí</title>
</head>
<body class="bg-gray-100 min-h-screen">

    <Nav />

    <div class="container mx-auto p-8">
        <h1 class="text-3xl font-semibold text-gray-700 mb-6">
            Récord Oficial de Boxeadores
        </h1>

        <div class="bg-white rounded-lg shadow-lg overflow-hidden">
            <table class="w-full">
                <thead class="bg-gray-50 border-b-2 border-gray-200">
                    <tr>
                        <th class="p-4 text-left text-sm font-semibold text-gray-600">Nombre</th>
                        <th class="p-4 text-center text-sm font-semibold text-gray-600">Victorias</th>
                        <th class="p-4 text-center text-sm font-semibold text-gray-600">Derrotas</th>
                        <th class="p-4 text-center text-sm font-semibold text-gray-600">Empates</th>
                    </tr>
                </thead>
                <tbody>
                    {boxeadores.length === 0 ? (
                        <tr>
                            <td colspan="4" class="p-4 text-center text-gray-500">
                                No hay boxeadores registrados.
                            </td>
                        </tr>
                    ) : (
                        boxeadores.map(boxeador => (
                            <tr class="border-b border-gray-200 hover:bg-gray-50">
                                <td class="p-4 font-medium text-gray-800">
    <a href={`/boxeador/${boxeador.id}`} class="text-blue-600 hover:underline">
        {boxeador.nombre}
    </a>
</td>
                                <td class="p-4 text-center text-gray-700">{boxeador.victorias}</td>
                                <td class="p-4 text-center text-gray-700">{boxeador.derrotas}</td>
                                <td class="p-4 text-center text-gray-700">{boxeador.empates}</td>
                            </tr>
                        ))
                    )}
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>